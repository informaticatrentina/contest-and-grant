Contest and grant
=================

In contest and grant project, one can create a contest. All contest must have
different name.  There are some entries related to each contest. Winners get
some grant and prices.


Installation
------------

To setup contest and grant you have to follow some steps mentioned below:

  . Download and setup yii framework  (see http://www.yiiframework.com/download/)
  . Checkout source code from repository into new directory (git@git.ahref.eu:apps/contest-and-grant.git)
      css                    contain all css file
      images                 contain all images used in project   
      js		           contain all js file 
      protected/           
        components           contain all api 
        config/              
          Config.php         This file have configuration of project
           test.php           This file have configuration for test cases 
        controllers          This directory contain all controller used in project. 
        extentions           extentions directory contain all extention used in project.  
        models               Bussiness logic puts here.
        runtime              Application log create in this directory 
        tests                Test cases put hare. 
        views/
          layout             This directory contain  layout of project.   
          contest            This directory contain html page that will be rendered from contest controller 
          template           This directory contain all templates 
      uploads                This directory contain subdirectory to save uploaded data (images file, text file etc). 
      index.php
      index-test.php
        
  . create database and change configuration (/protected/Config/config.php) 
  . create following directory for uploads on root:
      uploads
         contestImage
            resize  
         contestEntry 
            resize   

CONFIGURATION 
-------------
       
1. See local_config.php_sample file /protected/Config/local_config.php_sample)
   and copy this file as local_config.php (/protected/Config/local_config.php)

2. Configuration changes to be done in local_config.php

    a. BASE_URL Change its value to  site base url

    b. DB_HOST
       DB_NAME
       DB_USER
       DB_PASS

       This is setting for database connection. HOST, DATABASE_NAME,
       DATABASE_USER, DATABASE_PASSWORD: replace with host, name of database,
       database user name, and password of same user. (eg. host=localhost,
       dbname=contest, username = 'root', password='123456')

    c. AGGREGATOR_API_URL The complete API url of aggregator (which contains
       api key also)

    d. IDENTITY_MANAGER_API_URL The API url of identity manager installation
       this site will use.

    e. IDM_API_KEY API key of identity manager for this site.

    f. APP_LOG_FILE_NAME The name of application log file. Log file will be
       created inside /protected/runtime/LOG_FILE_NAME

       The current name in sample file allows you to create separate log file
       for each day. If you want to create one log file and have file rotation
       on it, just use a single name (one with date function)

    g. SITE_SESSION_COOKIE_NAME Name of cookie for session id.

    h. 'language' => 'SITE_LANGUAGE'
        SITE_LANGUAGE is language in which message have to be converted. (for
        English language you can use 'en')
    
   i.  SITE_TITLE The name of site title.
    
   j.  ALLOWED_IMAGE_EXTENSION The list of allowed extenstion for upload image. 
       This is define in  json format.
   
   k.  UPLOAD_IMAGE_SIZE_LIMIT The max size of uploading image in byte.
 

- Now contest and grants application is ready to run. If you want to run
  application on your local machine (apache server), you have to create
  .htaccess file on root directory(/var/www/project).  To see setting of
  .htaccess file, Please visit
  http://www.yiiframework.com/doc/guide/1.1/en/quickstart.apache-nginx-config


Upload Folder creation
------------------------
1. In main directory create folder "uploads" and give it write permission to wwww-data
2. Inside "uploads" folder create 2 folders "contestImage" and "contestEntry" and give tham write permission too.
3. Inside "contestImage" and "contestEntry" folder create "resize" folder and give it write permission.


Database Migration
------------------

Prerequisite:

1. You have setup the application
2. You have create a empty database
3. You have created config files. /protected/config/config.php and
   protected/config/console.php and pointed the right DB in it.

In order to migrate DB or perform DB updates run command::

    ./protected/yiic migrate

And follow instructions.


Create New Contest
-------------------
1. To create a new contest, Please go on :
   BASE_URL/contset/add
2. Fill up contest form and submit.

Only admin user can create a contest. 
In order to create admin user, Please add user email id in CONTEST_ADMIN_USERS array defined in local_config.php
  

Requirements
------------

Contest and grant is developed on yii framework So all requirements of yii
framework must be fulfilled:

The minimum requirement by Yii is that your Web server supports PHP 5.1.0 or
above.

Please access the following URL to check if your Web server reaches the
requirements by Yii, assuming "YiiPath" is where Yii is installed.


Backup and Restore
------------------

You have to backup:

- the configuration files
- the database
- the ``uploads`` directory


The contest and grant Developer Team
http://www.incaendo.com
